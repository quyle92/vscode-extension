{"version":3,"sources":["../webpack/bootstrap","../external \"vscode\"",".././src/statusBar.ts",".././src/utils.ts",".././src/main.ts",".././src/config.ts",".././src/tabnine.ts","../external \"child_process\"","../external \"fs\"","../external \"https\"","../external \"path\"",".././src/Trigger.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","require","TabNineStatus","statusBarItem","vscode","window","createStatusBarItem","StatusBarAlignment","Right","status","message","tooltip","Disabled","BinaryDoesNotExist","text","ActivationError","ParsingError","ProcessExited","ProcessDead","ProcessFailedToStart","ParsingSuccess","ProcessRunning","TimedOut","DownloadingBinary","fsp","fs","promises","tabNineBinariesPath","path","join","__dirname","getFullPathToTabNineBinary","version","architecture","process","arch","Error","getArchitecture","target","filename","platform","getTargetAndFileNameByPlatform","async","isFileExists","root","stat","err","code","versions","readdir","reverse","triedPaths","fullPath","push","binaryPath","tabNineVersionFromWeb","Promise","resolve","reject","requestUrl","requestVersion","https","timeout","res","output","on","chunk","trim","getTabNineVersionFromWeb","withProgress","location","ProgressLocation","Notification","cancellable","title","progress","token","binaryDirPath","slice","lastIndexOf","totalBinaryLength","mkdir","recursive","indexOf","requestDownload","binaryFile","createWriteStream","receivedBinaryLength","binaryPercentage","length","newBinaryPercentage","Number","parseInt","toFixed","report","increment","isCancellationRequested","showInformationMessage","pipe","onCancellationRequested","destroy","setTabNineStatus","headers","unlink","catch","showErrorMessage","console","error","vscodeConfig","getVSCodeConfig","provideCompletionItems","document","position","offset","offsetAt","beforeStartOffset","Math","max","charLimit","afterEndOffset","beforeStartPosition","positionAt","afterEndPosition","beforeStartPositionText","getText","Range","afterEndPositionText","responseFromTabNine","sendRequestToTabNine","Autocomplete","fileName","before","after","region_includes_beginning","region_includes_end","max_num_results","maxNumberOfResults","requestTimeout","debug","log","results","oldPrefixStartPosition","translate","old_prefix","userMessage","user_message","completionItems","resultsLength","resultEntry","completionItem","CompletionItem","new_prefix","endsWith","command","detail","documentation","kind","MarkdownString","insertText","SnippetString","new_suffix","label","appendTabstop","appendText","CompletionItemKind","Text","range","old_suffix","sortText","CompletionList","logError","registerTabNineCommand","commands","registerCommand","activeTextEditor","context","None","show","subscriptions","enable","downloadTabNineBinary","globalState","startAndHookIntoTabNineProcess","then","update","allVSCodeLanguages","languages","getLanguages","documentFilters","forEach","lang","disabledLanguagesIds","includes","scheme","language","registerCompletionItemProvider","Trigger","DOT","COLON","workspace","getConfiguration","tabNineProcess","tabNineVersion","numberOfRestarts","isTabNineProcessAlive","onTabNineProcessDeath","killed","setTimeout","kill","undefined","restartTabNineProcess","inheritStdio","args","getTabNineVersionAndBinaryPath","child_process","spawn","stdio","spawnTabNineProcess","stdin","stdout","unref","request","requestTimeoutMs","unregisterFunctions","onTabNineResponse","response","JSON","parse","toString","once","off","requestToTabNine","stringify","write","timeoutTabNineRequest","_","clearTimeout","tabNineProcessExit","onTabNineProcessExit","tabNineProcessDead","tokenCancelled","race","finally","fn"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n","module.exports = require(\"vscode\");","import * as vscode from \"vscode\";\n\nexport enum TabNineStatus {\n\tNone,\n\tDisabled,\n\tActivationError,\n\tBinaryDoesNotExist,\n\tParsingError,\n\tParsingSuccess,\n\tTimedOut,\n\tProcessExited,\n\tProcessDead,\n\tProcessRunning,\n\tProcessFailedToStart,\n\tDownloadingBinary,\n}\n\nexport const statusBarItem = vscode.window.createStatusBarItem(\n\tvscode.StatusBarAlignment.Right\n);\n\nexport function setTabNineStatus(status: TabNineStatus, message?: string) {\n\tstatusBarItem.tooltip = message;\n\n\tswitch (status) {\n\t\tcase TabNineStatus.Disabled:\n\t\tcase TabNineStatus.BinaryDoesNotExist: {\n\t\t\tstatusBarItem.text = \"TabNine: $(eye-closed)\";\n\t\t\tbreak;\n\t\t}\n\t\tcase TabNineStatus.ActivationError:\n\t\tcase TabNineStatus.ParsingError:\n\t\tcase TabNineStatus.ProcessExited:\n\t\tcase TabNineStatus.ProcessDead:\n\t\tcase TabNineStatus.ProcessFailedToStart: {\n\t\t\tstatusBarItem.text = \"TabNine: $(error)\";\n\t\t\tbreak;\n\t\t}\n\t\tcase TabNineStatus.ParsingSuccess:\n\t\tcase TabNineStatus.ProcessRunning: {\n\t\t\tstatusBarItem.text = \"TabNine: $(check)\";\n\t\t\tbreak;\n\t\t}\n\t\tcase TabNineStatus.TimedOut: {\n\t\t\tstatusBarItem.text = \"TabNine: $(watch)\";\n\t\t\tbreak;\n\t\t}\n\t\tcase TabNineStatus.DownloadingBinary: {\n\t\t\tstatusBarItem.text = \"TabNine: $(sync~spin)\";\n\t\t\tbreak;\n\t\t}\n\t\tdefault: {\n\t\t\tstatusBarItem.text = \"TabNine\";\n\t\t\tbreak;\n\t\t}\n\t}\n}\n","import * as fs from \"fs\";\nimport * as https from \"https\";\nimport * as path from \"path\";\nimport * as vscode from \"vscode\";\nimport { setTabNineStatus, TabNineStatus } from \"./statusBar\";\n\nconst fsp = fs.promises;\nconst tabNineBinariesPath = path.join(__dirname, \"..\", \"binaries\");\n\nexport async function getTabNineVersionAndBinaryPath(): Promise<{\n\tversion: string;\n\tbinaryPath: string;\n}> {\n\tconst versions = (await fsp.readdir(tabNineBinariesPath)).reverse();\n\tconst triedPaths: string[] = [];\n\n\tfor (const version of versions) {\n\t\tconst fullPath = getFullPathToTabNineBinary(version);\n\t\ttriedPaths.push(fullPath);\n\t\tif (await isFileExists(fullPath)) {\n\t\t\treturn { version, binaryPath: fullPath };\n\t\t}\n\t}\n\n\tthrow new Error(\n\t\t`Couldn't find TabNine binary (tried following versions=${versions} and paths=${triedPaths})`\n\t);\n}\n\nexport async function downloadTabNineBinary(\n\tversion: string | undefined\n): Promise<boolean> {\n\tif (version && (await isFileExists(getFullPathToTabNineBinary(version)))) {\n\t\treturn true;\n\t}\n\n\tconst tabNineVersionFromWeb = await getTabNineVersionFromWeb();\n\n\treturn vscode.window.withProgress(\n\t\t{\n\t\t\tlocation: vscode.ProgressLocation.Notification,\n\t\t\tcancellable: true,\n\t\t\ttitle: `Downloading TabNine ${tabNineVersionFromWeb} binary...`,\n\t\t},\n\t\t(progress, token) => {\n\t\t\treturn new Promise(async (resolve, reject) => {\n\t\t\t\ttry {\n\t\t\t\t\tconst fullPath = getFullPathToTabNineBinary(tabNineVersionFromWeb);\n\t\t\t\t\tconst binaryDirPath = fullPath.slice(0, fullPath.lastIndexOf(\"/\"));\n\t\t\t\t\tawait fsp.mkdir(binaryDirPath, { recursive: true });\n\n\t\t\t\t\tlet totalBinaryLength: string | undefined;\n\t\t\t\t\tconst requestUrl = `https://update.tabnine.com/${fullPath.slice(\n\t\t\t\t\t\tfullPath.indexOf(tabNineVersionFromWeb)\n\t\t\t\t\t)}`;\n\t\t\t\t\tconst requestDownload = https.get(\n\t\t\t\t\t\trequestUrl,\n\t\t\t\t\t\t{ timeout: 10_000 },\n\t\t\t\t\t\t(res) => {\n\t\t\t\t\t\t\tconst binaryFile = fs.createWriteStream(fullPath, {\n\t\t\t\t\t\t\t\tmode: 0o755,\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tbinaryFile.on(\"error\", (err) => reject(err));\n\n\t\t\t\t\t\t\tlet receivedBinaryLength = 0;\n\t\t\t\t\t\t\tlet binaryPercentage = 0;\n\t\t\t\t\t\t\tres\n\t\t\t\t\t\t\t\t.on(\"data\", (chunk) => {\n\t\t\t\t\t\t\t\t\tif (!totalBinaryLength) {\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\treceivedBinaryLength += chunk.length;\n\t\t\t\t\t\t\t\t\tconst newBinaryPercentage = Number(\n\t\t\t\t\t\t\t\t\t\t(\n\t\t\t\t\t\t\t\t\t\t\t(receivedBinaryLength * 100) /\n\t\t\t\t\t\t\t\t\t\t\tNumber.parseInt(totalBinaryLength)\n\t\t\t\t\t\t\t\t\t\t).toFixed()\n\t\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t\t\tif (binaryPercentage === 0) {\n\t\t\t\t\t\t\t\t\t\tprogress.report({ increment: 0 });\n\t\t\t\t\t\t\t\t\t} else if (newBinaryPercentage > binaryPercentage) {\n\t\t\t\t\t\t\t\t\t\tprogress.report({ increment: 1 });\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tbinaryPercentage = newBinaryPercentage;\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.on(\"error\", (err) => reject(err))\n\t\t\t\t\t\t\t\t.on(\"end\", () => {\n\t\t\t\t\t\t\t\t\tif (token.isCancellationRequested) {\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tprogress.report({ increment: 100 });\n\t\t\t\t\t\t\t\t\tvscode.window.showInformationMessage(\n\t\t\t\t\t\t\t\t\t\t`TabNine ${tabNineVersionFromWeb} binary is successfully downloaded`\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\tresolve(true);\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.pipe(binaryFile)\n\t\t\t\t\t\t\t\t.on(\"error\", (err) => reject(err));\n\n\t\t\t\t\t\t\ttoken.onCancellationRequested(() => {\n\t\t\t\t\t\t\t\tres.destroy();\n\t\t\t\t\t\t\t\tbinaryFile.destroy();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\n\t\t\t\t\trequestDownload.on(\"response\", (res) => {\n\t\t\t\t\t\tsetTabNineStatus(\n\t\t\t\t\t\t\tTabNineStatus.DownloadingBinary,\n\t\t\t\t\t\t\t`Downloading TabNine ${tabNineVersionFromWeb} binary`\n\t\t\t\t\t\t);\n\t\t\t\t\t\ttotalBinaryLength = res.headers[\"content-length\"];\n\t\t\t\t\t});\n\t\t\t\t\trequestDownload.on(\"timeout\", () =>\n\t\t\t\t\t\treject(`Request to ${requestUrl} timed out`)\n\t\t\t\t\t);\n\t\t\t\t\trequestDownload.on(\"error\", (err) => reject(err));\n\n\t\t\t\t\ttoken.onCancellationRequested(() => {\n\t\t\t\t\t\tfsp.unlink(fullPath).catch((err) => reject(err));\n\t\t\t\t\t\trequestDownload.destroy();\n\t\t\t\t\t\treject(\"Download of TabNine binary has been cancelled\");\n\t\t\t\t\t});\n\t\t\t\t} catch (err) {\n\t\t\t\t\treject(err);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t);\n}\n\nasync function getTabNineVersionFromWeb(): Promise<string> {\n\treturn new Promise((resolve, reject) => {\n\t\tconst requestUrl = \"https://update.tabnine.com/version\";\n\t\tconst requestVersion = https.get(requestUrl, { timeout: 10_000 }, (res) => {\n\t\t\tlet output = \"\";\n\t\t\tres.on(\"data\", (chunk) => (output += chunk));\n\t\t\tres.on(\"end\", () => resolve(output.trim()));\n\t\t\tres.on(\"error\", (err) => reject(err));\n\t\t});\n\n\t\trequestVersion.on(\"timeout\", () =>\n\t\t\treject(`Request to ${requestUrl} timed out`)\n\t\t);\n\t\trequestVersion.on(\"error\", (err) => reject(err));\n\t});\n}\n\nfunction getFullPathToTabNineBinary(version: string): string {\n\tconst architecture = getArchitecture();\n\tconst { target, filename } = getTargetAndFileNameByPlatform();\n\treturn `${tabNineBinariesPath}/${version}/${architecture}-${target}/${filename}`;\n}\n\nfunction getArchitecture(): string {\n\tif (process.arch === \"x32\" || process.arch === \"ia32\") {\n\t\treturn \"i686\";\n\t}\n\tif (process.arch === \"x64\") {\n\t\treturn \"x86_64\";\n\t}\n\tthrow new Error(`Architecture \"${process.arch}\" is not supported by TabNine`);\n}\n\nfunction getTargetAndFileNameByPlatform(): {\n\ttarget: string;\n\tfilename: string;\n} {\n\tif (process.platform === \"win32\") {\n\t\treturn { target: \"pc-windows-gnu\", filename: \"TabNine.exe\" };\n\t}\n\tif (process.platform === \"darwin\") {\n\t\treturn { target: \"apple-darwin\", filename: \"TabNine\" };\n\t}\n\tif (process.platform === \"linux\") {\n\t\treturn { target: \"unknown-linux-musl\", filename: \"TabNine\" };\n\t}\n\tthrow new Error(`Platform \"${process.platform}\" is not supported by TabNine`);\n}\n\nasync function isFileExists(root: string): Promise<boolean> {\n\ttry {\n\t\tawait fsp.stat(root);\n\t\treturn true;\n\t} catch (err) {\n\t\tif (err.code === \"ENOENT\") {\n\t\t\treturn false;\n\t\t}\n\t\tthrow err;\n\t}\n}\n\nexport function showErrorMessage(err: any) {\n\tvscode.window.showErrorMessage(err instanceof Error ? err.message : err);\n}\n\nexport function logError(err: any) {\n\tconsole.error(err instanceof Error ? err.message : err);\n}\n","import * as vscode from \"vscode\";\nimport { getVSCodeConfig } from \"./config\";\nimport { setTabNineStatus, statusBarItem, TabNineStatus } from \"./statusBar\";\nimport {\n\tsendRequestToTabNine,\n\tstartAndHookIntoTabNineProcess,\n} from \"./tabnine\";\nimport { Trigger } from \"./Trigger\";\nimport { downloadTabNineBinary, logError, showErrorMessage } from \"./utils\";\n\nconst DEFAULT_DETAIL_MESSAGE = \"TabNine\";\nconst TABNINE_VERSION_KEY = \"TABNINE_VERSION\";\nconst vscodeConfig = getVSCodeConfig();\n\nexport async function activate(context: vscode.ExtensionContext) {\n\ttry {\n\t\tsetTabNineStatus(TabNineStatus.None);\n\t\tstatusBarItem.show();\n\t\tcontext.subscriptions.push(statusBarItem);\n\n\t\tif (!vscodeConfig.enable) {\n\t\t\tsetTabNineStatus(\n\t\t\t\tTabNineStatus.Disabled,\n\t\t\t\t\"TabNine is disabled via config\"\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\n\t\tconst isTabNineBinaryDownloaded = await downloadTabNineBinary(\n\t\t\tcontext.globalState.get(TABNINE_VERSION_KEY)\n\t\t);\n\t\tif (!isTabNineBinaryDownloaded) {\n\t\t\tsetTabNineStatus(\n\t\t\t\tTabNineStatus.BinaryDoesNotExist,\n\t\t\t\t\"TabNine binary does not exist\"\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\n\t\tstartAndHookIntoTabNineProcess()\n\t\t\t.then((version) => {\n\t\t\t\tcontext.globalState.update(TABNINE_VERSION_KEY, version);\n\t\t\t})\n\t\t\t.catch((err) => {\n\t\t\t\tsetTabNineStatus(\n\t\t\t\t\tTabNineStatus.ProcessFailedToStart,\n\t\t\t\t\t\"TabNine process failed to start\"\n\t\t\t\t);\n\t\t\t\tshowErrorMessage(err);\n\t\t\t});\n\n\t\tconst allVSCodeLanguages = await vscode.languages.getLanguages();\n\t\tconst documentFilters: vscode.DocumentFilter[] = [];\n\n\t\tallVSCodeLanguages.forEach((lang) => {\n\t\t\tif (vscodeConfig.disabledLanguagesIds.includes(lang)) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tdocumentFilters.push(\n\t\t\t\t{ scheme: \"file\", language: lang },\n\t\t\t\t{ scheme: \"untitled\", language: lang }\n\t\t\t);\n\t\t});\n\n\t\tcontext.subscriptions.push(\n\t\t\tvscode.languages.registerCompletionItemProvider(\n\t\t\t\tdocumentFilters,\n\t\t\t\t{ provideCompletionItems },\n\t\t\t\tTrigger.DOT,\n\t\t\t\tTrigger.COLON\n\t\t\t),\n\t\t\tregisterTabNineCommand(\"TabNine::config\"),\n\t\t\tregisterTabNineCommand(\"TabNine::restart\"),\n\t\t\tregisterTabNineCommand(\"TabNine::sem\"),\n\t\t\tregisterTabNineCommand(\"TabNine::no_sem\")\n\t\t);\n\t} catch (err) {\n\t\tsetTabNineStatus(\n\t\t\tTabNineStatus.ActivationError,\n\t\t\terr instanceof Error ? err.message : err\n\t\t);\n\t\tshowErrorMessage(err);\n\t}\n}\n\nasync function provideCompletionItems(\n\tdocument: vscode.TextDocument,\n\tposition: vscode.Position,\n\ttoken?: vscode.CancellationToken\n) {\n\ttry {\n\t\tif (token?.isCancellationRequested) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst offset = document.offsetAt(position);\n\t\tconst beforeStartOffset = Math.max(0, offset - vscodeConfig.charLimit);\n\t\tconst afterEndOffset = offset + vscodeConfig.charLimit;\n\t\tconst beforeStartPosition = document.positionAt(beforeStartOffset);\n\t\tconst afterEndPosition = document.positionAt(afterEndOffset);\n\t\tconst beforeStartPositionText = document.getText(\n\t\t\tnew vscode.Range(beforeStartPosition, position)\n\t\t);\n\t\tconst afterEndPositionText = document.getText(\n\t\t\tnew vscode.Range(position, afterEndPosition)\n\t\t);\n\n\t\tconst responseFromTabNine = await sendRequestToTabNine(\n\t\t\t{\n\t\t\t\tAutocomplete: {\n\t\t\t\t\tfilename: document.fileName,\n\t\t\t\t\tbefore: beforeStartPositionText,\n\t\t\t\t\tafter: afterEndPositionText,\n\t\t\t\t\tregion_includes_beginning: beforeStartOffset === 0,\n\t\t\t\t\tregion_includes_end:\n\t\t\t\t\t\tdocument.offsetAt(afterEndPosition) !== afterEndOffset,\n\t\t\t\t\tmax_num_results: vscodeConfig.maxNumberOfResults,\n\t\t\t\t},\n\t\t\t},\n\t\t\tvscodeConfig.requestTimeout,\n\t\t\ttoken?.onCancellationRequested\n\t\t);\n\n\t\tif (token?.isCancellationRequested) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (vscodeConfig.debug) {\n\t\t\tconsole.log(responseFromTabNine);\n\t\t}\n\n\t\tif (responseFromTabNine.results.length === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst oldPrefixStartPosition = position.translate(\n\t\t\t0,\n\t\t\t-responseFromTabNine.old_prefix.length\n\t\t);\n\t\tconst userMessage = responseFromTabNine.user_message.join(\" \");\n\n\t\tconst completionItems: vscode.CompletionItem[] = [];\n\t\tlet resultsLength = responseFromTabNine.results.length;\n\t\tif (resultsLength > vscodeConfig.maxNumberOfResults) {\n\t\t\tresultsLength = vscodeConfig.maxNumberOfResults;\n\t\t}\n\n\t\tfor (let i = 0; i < resultsLength; i++) {\n\t\t\tconst resultEntry = responseFromTabNine.results[i];\n\t\t\tconst completionItem = new vscode.CompletionItem(resultEntry.new_prefix);\n\n\t\t\tif (\n\t\t\t\tresultEntry.new_prefix.endsWith(\".\") ||\n\t\t\t\tresultEntry.new_prefix.endsWith(\"::\")\n\t\t\t) {\n\t\t\t\tcompletionItem.command = {\n\t\t\t\t\ttitle: \"\",\n\t\t\t\t\tcommand: \"editor.action.triggerSuggest\",\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif (resultEntry.detail) {\n\t\t\t\tcompletionItem.detail = resultEntry.detail;\n\t\t\t} else {\n\t\t\t\tcompletionItem.detail = DEFAULT_DETAIL_MESSAGE;\n\t\t\t}\n\n\t\t\tif (resultEntry.documentation) {\n\t\t\t\tif (typeof resultEntry.documentation === \"object\") {\n\t\t\t\t\tif (resultEntry.documentation.kind === \"markdown\") {\n\t\t\t\t\t\tcompletionItem.documentation = new vscode.MarkdownString(\n\t\t\t\t\t\t\tresultEntry.documentation.value\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcompletionItem.documentation = resultEntry.documentation.value;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tcompletionItem.documentation = resultEntry.documentation;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tcompletionItem.documentation = userMessage;\n\t\t\t}\n\n\t\t\tcompletionItem.insertText = new vscode.SnippetString(\n\t\t\t\tresultEntry.new_prefix\n\t\t\t);\n\t\t\tif (resultEntry.new_suffix) {\n\t\t\t\tcompletionItem.label += resultEntry.new_suffix;\n\n\t\t\t\tcompletionItem.insertText\n\t\t\t\t\t.appendTabstop(0)\n\t\t\t\t\t.appendText(resultEntry.new_suffix);\n\t\t\t}\n\n\t\t\tcompletionItem.kind = vscode.CompletionItemKind.Text;\n\t\t\tcompletionItem.range = new vscode.Range(\n\t\t\t\toldPrefixStartPosition,\n\t\t\t\tposition.translate(0, resultEntry.old_suffix.length)\n\t\t\t);\n\t\t\tcompletionItem.sortText = \"\\uffff9999\" + i;\n\n\t\t\tcompletionItems.push(completionItem);\n\t\t}\n\n\t\treturn new vscode.CompletionList(completionItems, true);\n\t} catch (err) {\n\t\tif (vscodeConfig.debug) {\n\t\t\tlogError(err);\n\t\t}\n\t}\n}\n\nfunction registerTabNineCommand(command: string): vscode.Disposable {\n\treturn vscode.commands.registerCommand(command, async () => {\n\t\ttry {\n\t\t\tconst responseFromTabNine = await sendRequestToTabNine(\n\t\t\t\t{\n\t\t\t\t\tAutocomplete: {\n\t\t\t\t\t\tfilename: vscode.window.activeTextEditor?.document.fileName ?? \"\",\n\t\t\t\t\t\tbefore: command,\n\t\t\t\t\t\tafter: command,\n\t\t\t\t\t\tregion_includes_beginning: true,\n\t\t\t\t\t\tregion_includes_end: true,\n\t\t\t\t\t\tmax_num_results: 1,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t1000\n\t\t\t);\n\t\t\tvscode.window.showInformationMessage(\n\t\t\t\tresponseFromTabNine.results[0].new_prefix\n\t\t\t);\n\t\t} catch (err) {\n\t\t\tshowErrorMessage(err);\n\t\t}\n\t});\n}\n","import * as vscode from \"vscode\";\n\ninterface Config {\n\tenable: boolean;\n\tdebug: boolean;\n\tmaxNumberOfResults: number;\n\tdisabledLanguagesIds: string[];\n\trequestTimeout: number;\n\tcharLimit: number;\n}\n\nexport function getVSCodeConfig(): Config {\n\treturn vscode.workspace.getConfiguration(\"tabnine\") as any;\n}\n","import * as child_process from \"child_process\";\nimport * as vscode from \"vscode\";\nimport { setTabNineStatus, TabNineStatus } from \"./statusBar\";\nimport { getTabNineVersionAndBinaryPath, logError } from \"./utils\";\n\nexport interface TabNineAutocompleteResponse {\n\tdocs: string[];\n\told_prefix: string;\n\tresults: TabNineResultEntry[];\n\tuser_message: string[];\n}\n\nexport interface TabNineResultEntry {\n\tnew_prefix: string;\n\told_suffix: string;\n\tnew_suffix: string;\n\tkind?: vscode.CompletionItemKind;\n\tdetail?: string;\n\tdocumentation?: string | TabNineMarkdownStringSpec;\n\tdeprecated?: boolean;\n}\n\nexport interface TabNineMarkdownStringSpec {\n\tkind: string;\n\tvalue: string;\n}\n\nconst MAX_NUMBER_OF_RESTARTS = 10;\nconst RESTART_AFTER_MS = 10_000;\n\nlet tabNineProcess: child_process.ChildProcess | undefined;\nlet tabNineVersion: string | undefined;\nlet numberOfRestarts = 0;\nlet isTabNineProcessAlive = false;\n\nexport async function sendRequestToTabNine(\n\trequest: {\n\t\t[key: string]: any;\n\t},\n\trequestTimeoutMs: number,\n\tonCancellationRequested?: vscode.Event<any>\n): Promise<TabNineAutocompleteResponse> {\n\trequest = {\n\t\tversion: tabNineVersion,\n\t\trequest,\n\t};\n\n\tconst unregisterFunctions: (() => void)[] = [];\n\n\tconst responseFromTabNine = new Promise((resolve, reject) => {\n\t\tconst onTabNineResponse = (response: Buffer) => {\n\t\t\ttry {\n\t\t\t\tsetTabNineStatus(\n\t\t\t\t\tTabNineStatus.ParsingSuccess,\n\t\t\t\t\t`TabNine ${tabNineVersion} process is running`\n\t\t\t\t);\n\t\t\t\tresolve(JSON.parse(response.toString()));\n\t\t\t} catch (err) {\n\t\t\t\tsetTabNineStatus(\n\t\t\t\t\tTabNineStatus.ParsingError,\n\t\t\t\t\t\"Error while parsing response from TabNine\"\n\t\t\t\t);\n\t\t\t\treject(`TabNine response parsing error: ${err}`);\n\t\t\t}\n\t\t};\n\n\t\ttabNineProcess?.stdout?.once(\"data\", onTabNineResponse);\n\n\t\tunregisterFunctions.push(() => {\n\t\t\ttabNineProcess?.stdout?.off(\"data\", onTabNineResponse);\n\t\t});\n\n\t\tconst requestToTabNine = JSON.stringify(request) + \"\\n\";\n\t\ttabNineProcess?.stdin?.write(requestToTabNine, \"utf-8\");\n\t});\n\n\tconst timeoutTabNineRequest = new Promise((_, reject) => {\n\t\tconst requestTimeout = setTimeout(() => {\n\t\t\tsetTabNineStatus(TabNineStatus.TimedOut, \"Request to TabNine timed out\");\n\t\t\treject(\"Request to TabNine timed out\");\n\t\t}, requestTimeoutMs);\n\n\t\tunregisterFunctions.push(() => clearTimeout(requestTimeout));\n\t});\n\n\tconst tabNineProcessExit = new Promise((_, reject) => {\n\t\tconst onTabNineProcessExit = () => {\n\t\t\tsetTabNineStatus(TabNineStatus.ProcessExited, \"TabNine process exited\");\n\t\t\treject(\"TabNine process exited\");\n\t\t};\n\n\t\ttabNineProcess?.once(\"exit\", onTabNineProcessExit);\n\n\t\tunregisterFunctions.push(() => {\n\t\t\ttabNineProcess?.off(\"exit\", onTabNineProcessExit);\n\t\t});\n\t});\n\n\tconst tabNineProcessDead = new Promise((_, reject) => {\n\t\tif (!isTabNineProcessAlive) {\n\t\t\tsetTabNineStatus(\n\t\t\t\tTabNineStatus.ProcessDead,\n\t\t\t\t\"TabNine process is currently dead\"\n\t\t\t);\n\t\t\treject(\"TabNine process is currently dead\");\n\t\t}\n\t});\n\n\tconst tokenCancelled = new Promise((_, reject) => {\n\t\tonCancellationRequested?.(() => {\n\t\t\treject(\"Token has been cancelled\");\n\t\t});\n\t});\n\n\treturn Promise.race([\n\t\tresponseFromTabNine,\n\t\ttimeoutTabNineRequest,\n\t\ttabNineProcessExit,\n\t\ttabNineProcessDead,\n\t\ttokenCancelled,\n\t]).finally(() => {\n\t\tunregisterFunctions.forEach((fn) => fn());\n\t}) as Promise<TabNineAutocompleteResponse>;\n}\n\n/**\n * Spawns a new TabNine process by running executable from \"binaries\" folder.\n */\nasync function spawnTabNineProcess(\n\tinheritStdio = false,\n\t...args: string[]\n): Promise<{\n\tversion: string;\n\tprocess: child_process.ChildProcess;\n}> {\n\tconst { version, binaryPath } = await getTabNineVersionAndBinaryPath();\n\treturn {\n\t\tversion,\n\t\tprocess: child_process.spawn(binaryPath, [\"--client=vscode\", ...args], {\n\t\t\tstdio: inheritStdio ? \"inherit\" : \"pipe\",\n\t\t}),\n\t};\n}\n\nfunction onTabNineProcessDeath(err?: string): void {\n\tif (tabNineProcess?.killed) {\n\t\treturn;\n\t}\n\tif (err) {\n\t\tlogError(err);\n\t}\n\n\tisTabNineProcessAlive = false;\n\tsetTimeout(() => restartTabNineProcess(), RESTART_AFTER_MS);\n}\n\nasync function restartTabNineProcess(): Promise<void> {\n\tif (isTabNineProcessAlive) {\n\t\treturn;\n\t}\n\tif (numberOfRestarts >= MAX_NUMBER_OF_RESTARTS) {\n\t\tlogError(\"TabNine process exceeded maximum number of restarts\");\n\t\treturn;\n\t}\n\n\tnumberOfRestarts += 1;\n\ttabNineProcess?.kill();\n\ttabNineProcess = undefined;\n\tawait startAndHookIntoTabNineProcess();\n}\n\n/**\n * Starts and hooks into a new TabNine process.\n * @returns TabNine version.\n */\nexport async function startAndHookIntoTabNineProcess(): Promise<string> {\n\tconst { version, process } = await spawnTabNineProcess();\n\ttabNineVersion = version;\n\ttabNineProcess = process;\n\tisTabNineProcessAlive = true;\n\tsetTabNineStatus(\n\t\tTabNineStatus.ProcessRunning,\n\t\t`TabNine ${tabNineVersion} process is running`\n\t);\n\n\ttabNineProcess.on(\"exit\", () => {\n\t\tonTabNineProcessDeath();\n\t});\n\ttabNineProcess.stdin?.on(\"error\", (err) => {\n\t\tonTabNineProcessDeath(`TabNine stdin error: ${err}`);\n\t});\n\ttabNineProcess.stdout?.on(\"error\", (err) => {\n\t\tonTabNineProcessDeath(`TabNine stdout error: ${err}`);\n\t});\n\n\ttabNineProcess.unref();\n\n\treturn version;\n}\n","module.exports = require(\"child_process\");","module.exports = require(\"fs\");","module.exports = require(\"https\");","module.exports = require(\"path\");","export enum Trigger {\n\tDOT = \".\",\n\tCOLON = \":\",\n}\n"],"sourceRoot":""}